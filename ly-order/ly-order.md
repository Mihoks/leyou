### 订单微服务：实现订单相关服务
 - 订单的表设计，状态记录
 - 创建订单需要同时减少库存，跨服务业务，需要注意事务处理
    - 查询订单提交的商品信息
    - 计算订单总价格
    - 写入订单、订单详情、订单状态
    - 减少库存，远程同步调用商品微服务，实现库存减少（若采用异步减库存，可能需要引入分布式事务）
    
订单数据非常庞大，将来一定会做分库分表。那么这种情况下，要保证id的唯一，就不能靠数据库自增，而是自己来实现算法，生成唯一id。
这里采用的生成id算法，是由Twitter公司开源的snowflake（雪花）算法。雪花算法会生成一个64位的二进制数据，为一个Long型。(转换成字符串后长度最多19位) ，其基本结构：

![image](../imgs/1528729105237.png)
第一位：为未使用
第二部分：41位为毫秒级时间(41位的长度可以使用69年)
第三部分：5位datacenterId和5位workerId(10位的长度最多支持部署1024个节点）
第四部分：最后12位是毫秒内的计数（12位的计数顺序号支持每个节点每毫秒产生4096个ID序号）
snowflake生成的ID整体上按照时间自增排序，并且整个分布式系统内不会产生ID碰撞（由datacenter和workerId作区分），并且效率较高。经测试snowflake每秒能够产生26万个ID。